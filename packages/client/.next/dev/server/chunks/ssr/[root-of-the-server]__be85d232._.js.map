{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/haoqi/OnePersonCompany/friendsAI/packages/client/components/chat/ChatComposer.tsx"],"sourcesContent":["import { Send, Mic, Plus, Image, Camera, FileVideo, Locate } from 'lucide-react';\nimport { useState } from 'react';\n\ntype ComposerTool = 'add' | 'image' | 'camera' | 'gif' | 'location';\n\ninterface ChatComposerProps {\n  onSendMessage: (message: string) => void;\n  onToolAction: (tool: ComposerTool) => void;\n  onVoiceInput: () => void;\n  disabled?: boolean;\n}\n\nconst TOOL_ICONS: Array<{ Icon: typeof Plus; name: ComposerTool }> = [\n  { Icon: Plus, name: 'add' },\n  { Icon: Image, name: 'image' },\n  { Icon: Camera, name: 'camera' },\n  { Icon: FileVideo, name: 'gif' },\n  { Icon: Locate, name: 'location' },\n];\n\nexport function ChatComposer({\n  onSendMessage,\n  onToolAction,\n  onVoiceInput,\n  disabled = false,\n}: ChatComposerProps) {\n  const [input, setInput] = useState('');\n\n  const handleSend = () => {\n    const trimmed = input.trim();\n    if (!trimmed) {\n      return;\n    }\n\n    onSendMessage(trimmed);\n    setInput('');\n  };\n\n  return (\n    <div className=\"border-t border-gray-200 bg-[#F5F5F7] px-3 py-3\">\n      <div className=\"flex flex-col gap-1.5\">\n        <div className=\"flex h-7 items-center gap-4\">\n          {TOOL_ICONS.map(({ Icon, name }) => (\n            <button\n              key={name}\n              type=\"button\"\n              onClick={() => onToolAction(name)}\n              className=\"text-gray-400 transition-colors hover:text-gray-600\"\n              aria-label={name}\n              disabled={disabled}\n            >\n              <Icon className=\"h-5 w-5\" />\n            </button>\n          ))}\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          <input\n            type=\"text\"\n            value={input}\n            onChange={(e) => setInput(e.target.value)}\n            onKeyDown={(e) => {\n              if (e.key === 'Enter' && !e.shiftKey) {\n                e.preventDefault();\n                handleSend();\n              }\n            }}\n            placeholder=\"输入消息…\"\n            disabled={disabled}\n            className=\"flex-1 rounded-[20px] border border-gray-200 bg-white px-4 py-2 text-sm placeholder-gray-400 focus:border-blue-500 focus:outline-none disabled:opacity-50\"\n          />\n\n          <button\n            type=\"button\"\n            onClick={onVoiceInput}\n            className=\"flex h-9 w-9 items-center justify-center text-gray-900 transition-colors hover:text-gray-600\"\n            aria-label=\"Voice input\"\n            disabled={disabled}\n          >\n            <Mic className=\"h-5 w-5\" />\n          </button>\n\n          <button\n            type=\"button\"\n            onClick={handleSend}\n            disabled={disabled || !input.trim()}\n            className=\"flex h-9 w-9 items-center justify-center rounded-full bg-[#007AFF] text-white transition-colors hover:bg-blue-600 disabled:opacity-50\"\n            aria-label=\"Send message\"\n          >\n            <Send className=\"h-4 w-4\" />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;AAWA,MAAM,aAA+D;IACnE;QAAE,MAAM,2OAAI;QAAE,MAAM;IAAM;IAC1B;QAAE,MAAM,8OAAK;QAAE,MAAM;IAAQ;IAC7B;QAAE,MAAM,iPAAM;QAAE,MAAM;IAAS;IAC/B;QAAE,MAAM,6PAAS;QAAE,MAAM;IAAM;IAC/B;QAAE,MAAM,iPAAM;QAAE,MAAM;IAAW;CAClC;AAEM,SAAS,aAAa,EAC3B,aAAa,EACb,YAAY,EACZ,YAAY,EACZ,WAAW,KAAK,EACE;IAClB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,kPAAQ,EAAC;IAEnC,MAAM,aAAa;QACjB,MAAM,UAAU,MAAM,IAAI;QAC1B,IAAI,CAAC,SAAS;YACZ;QACF;QAEA,cAAc;QACd,SAAS;IACX;IAEA,qBACE,+QAAC;QAAI,WAAU;kBACb,cAAA,+QAAC;YAAI,WAAU;;8BACb,+QAAC;oBAAI,WAAU;8BACZ,WAAW,GAAG,CAAC,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,iBAC7B,+QAAC;4BAEC,MAAK;4BACL,SAAS,IAAM,aAAa;4BAC5B,WAAU;4BACV,cAAY;4BACZ,UAAU;sCAEV,cAAA,+QAAC;gCAAK,WAAU;;;;;;2BAPX;;;;;;;;;;8BAYX,+QAAC;oBAAI,WAAU;;sCACb,+QAAC;4BACC,MAAK;4BACL,OAAO;4BACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;4BACxC,WAAW,CAAC;gCACV,IAAI,EAAE,GAAG,KAAK,WAAW,CAAC,EAAE,QAAQ,EAAE;oCACpC,EAAE,cAAc;oCAChB;gCACF;4BACF;4BACA,aAAY;4BACZ,UAAU;4BACV,WAAU;;;;;;sCAGZ,+QAAC;4BACC,MAAK;4BACL,SAAS;4BACT,WAAU;4BACV,cAAW;4BACX,UAAU;sCAEV,cAAA,+QAAC,wOAAG;gCAAC,WAAU;;;;;;;;;;;sCAGjB,+QAAC;4BACC,MAAK;4BACL,SAAS;4BACT,UAAU,YAAY,CAAC,MAAM,IAAI;4BACjC,WAAU;4BACV,cAAW;sCAEX,cAAA,+QAAC,2OAAI;gCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM5B"}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///Users/haoqi/OnePersonCompany/friendsAI/packages/client/stores/chat.ts"],"sourcesContent":["import { create } from 'zustand';\nimport type { Contact, Message } from '@/types';\n\ninterface ChatStore {\n  // Current state\n  activeContactId: string | null;\n  isDrawerOpen: boolean;\n  contacts: Contact[];\n  messages: Record<string, Message[]>;\n\n  // Actions\n  setActiveContact: (contactId: string) => void;\n  toggleDrawer: () => void;\n  setDrawerOpen: (open: boolean) => void;\n  setContacts: (contacts: Contact[]) => void;\n  addContact: (contact: Contact) => void;\n  setMessages: (contactId: string, messages: Message[]) => void;\n  addMessage: (contactId: string, message: Message) => void;\n  updateMessage: (contactId: string, messageId: string, updater: (message: Message) => Message) => void;\n}\n\nexport const useChatStore = create<ChatStore>((set) => ({\n  // Initial state\n  activeContactId: null,\n  isDrawerOpen: false,\n  contacts: [],\n  messages: {},\n\n  // Actions\n  setActiveContact: (contactId) =>\n    set({ activeContactId: contactId, isDrawerOpen: false }),\n\n  toggleDrawer: () =>\n    set((state) => ({ isDrawerOpen: !state.isDrawerOpen })),\n\n  setDrawerOpen: (open) => set({ isDrawerOpen: open }),\n\n  setContacts: (contacts) => set({ contacts }),\n\n  addContact: (contact) =>\n    set((state) => ({\n      contacts: [...state.contacts, contact],\n    })),\n\n  setMessages: (contactId, messages) =>\n    set((state) => ({\n      messages: { ...state.messages, [contactId]: messages },\n    })),\n\n  addMessage: (contactId, message) =>\n    set((state) => ({\n      messages: {\n        ...state.messages,\n        [contactId]: [...(state.messages[contactId] || []), message],\n      },\n    })),\n\n  updateMessage: (contactId, messageId, updater) =>\n    set((state) => ({\n      messages: {\n        ...state.messages,\n        [contactId]: (state.messages[contactId] || []).map((message) =>\n          message.id === messageId ? updater(message) : message\n        ),\n      },\n    })),\n}));\n"],"names":[],"mappings":";;;;AAAA;;AAqBO,MAAM,eAAe,IAAA,mLAAM,EAAY,CAAC,MAAQ,CAAC;QACtD,gBAAgB;QAChB,iBAAiB;QACjB,cAAc;QACd,UAAU,EAAE;QACZ,UAAU,CAAC;QAEX,UAAU;QACV,kBAAkB,CAAC,YACjB,IAAI;gBAAE,iBAAiB;gBAAW,cAAc;YAAM;QAExD,cAAc,IACZ,IAAI,CAAC,QAAU,CAAC;oBAAE,cAAc,CAAC,MAAM,YAAY;gBAAC,CAAC;QAEvD,eAAe,CAAC,OAAS,IAAI;gBAAE,cAAc;YAAK;QAElD,aAAa,CAAC,WAAa,IAAI;gBAAE;YAAS;QAE1C,YAAY,CAAC,UACX,IAAI,CAAC,QAAU,CAAC;oBACd,UAAU;2BAAI,MAAM,QAAQ;wBAAE;qBAAQ;gBACxC,CAAC;QAEH,aAAa,CAAC,WAAW,WACvB,IAAI,CAAC,QAAU,CAAC;oBACd,UAAU;wBAAE,GAAG,MAAM,QAAQ;wBAAE,CAAC,UAAU,EAAE;oBAAS;gBACvD,CAAC;QAEH,YAAY,CAAC,WAAW,UACtB,IAAI,CAAC,QAAU,CAAC;oBACd,UAAU;wBACR,GAAG,MAAM,QAAQ;wBACjB,CAAC,UAAU,EAAE;+BAAK,MAAM,QAAQ,CAAC,UAAU,IAAI,EAAE;4BAAG;yBAAQ;oBAC9D;gBACF,CAAC;QAEH,eAAe,CAAC,WAAW,WAAW,UACpC,IAAI,CAAC,QAAU,CAAC;oBACd,UAAU;wBACR,GAAG,MAAM,QAAQ;wBACjB,CAAC,UAAU,EAAE,CAAC,MAAM,QAAQ,CAAC,UAAU,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC,UAClD,QAAQ,EAAE,KAAK,YAAY,QAAQ,WAAW;oBAElD;gBACF,CAAC;IACL,CAAC"}},
    {"offset": {"line": 225, "column": 0}, "map": {"version":3,"sources":["file:///Users/haoqi/OnePersonCompany/friendsAI/packages/client/components/chat/ChatHeader.tsx"],"sourcesContent":["import { Menu, MoreVertical } from 'lucide-react';\nimport { useChatStore } from '@/stores/chat';\nimport type { Contact } from '@/types';\n\ninterface ChatHeaderProps {\n  contact: Contact | null;\n}\n\nexport function ChatHeader({ contact }: ChatHeaderProps) {\n  const toggleDrawer = useChatStore((state) => state.toggleDrawer);\n\n  return (\n    <header className=\"flex h-16 items-center justify-between border-b border-gray-200 bg-[#F5F5F7] px-5\">\n      <button\n        onClick={toggleDrawer}\n        className=\"flex h-6 w-6 items-center justify-center text-gray-900\"\n        aria-label=\"Open contacts\"\n      >\n        <Menu className=\"h-6 w-6\" />\n      </button>\n\n      <h1 className=\"text-base font-semibold text-gray-900\">\n        {contact?.name || '新联系人'}\n      </h1>\n\n      <button\n        className=\"flex h-6 w-6 items-center justify-center text-gray-900\"\n        aria-label=\"More options\"\n      >\n        <MoreVertical className=\"h-6 w-6\" />\n      </button>\n    </header>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AACA;;;;AAOO,SAAS,WAAW,EAAE,OAAO,EAAmB;IACrD,MAAM,eAAe,IAAA,qLAAY,EAAC,CAAC,QAAU,MAAM,YAAY;IAE/D,qBACE,+QAAC;QAAO,WAAU;;0BAChB,+QAAC;gBACC,SAAS;gBACT,WAAU;gBACV,cAAW;0BAEX,cAAA,+QAAC,2OAAI;oBAAC,WAAU;;;;;;;;;;;0BAGlB,+QAAC;gBAAG,WAAU;0BACX,SAAS,QAAQ;;;;;;0BAGpB,+QAAC;gBACC,WAAU;gBACV,cAAW;0BAEX,cAAA,+QAAC,2QAAY;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAIhC"}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///Users/haoqi/OnePersonCompany/friendsAI/packages/client/components/chat/MessageBubble.tsx"],"sourcesContent":["import type { Message } from '@/types';\nimport ReactMarkdown from 'react-markdown';\nimport { Bot } from 'lucide-react';\n\n\ninterface MessageBubbleProps {\n  message: Message;\n}\n\nconst AVATAR_COLORS = {\n  user: '#007AFF',\n  assistant: '#E5E5EA',\n} as const;\n\nexport function MessageBubble({ message }: MessageBubbleProps) {\n  const isUser = message.role === 'user';\n\n  return (\n    <div className={`flex w-full ${isUser ? 'justify-end' : 'justify-start'}`}>\n      <div\n        className=\"max-w-[260px] rounded-[20px] px-3 py-3\"\n        style={{\n          backgroundColor: isUser ? AVATAR_COLORS.user : AVATAR_COLORS.assistant,\n        }}\n      >\n        {message.toolCalls && message.toolCalls.length > 0 && (\n          <div className=\"mb-2 space-y-1\">\n            {message.toolCalls.map((tool) => (\n              <div\n                key={tool.id}\n                className=\"rounded-lg bg-white/50 p-2 text-xs\"\n              >\n                <div className=\"flex items-center gap-1 font-semibold\">\n                  <Bot className=\"h-3 w-3\" />\n                  <span>{tool.name}</span>\n                </div>\n                {tool.result && (\n                  <div className=\"mt-1 text-gray-600\">{tool.result}</div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n        {isUser ? (\n          <p className=\"text-sm leading-relaxed whitespace-pre-wrap text-white\">\n            {message.content}\n          </p>\n        ) : (\n          <MarkdownTextPrimitive\n            className=\"text-sm leading-relaxed text-gray-900 [&_a]:text-blue-600 [&_a]:underline [&_code]:rounded [&_code]:bg-black/5 [&_code]:px-1 [&_code]:py-0.5 [&_pre]:overflow-x-auto [&_pre]:rounded-lg [&_pre]:bg-black/5 [&_pre]:p-2 [&_ul]:list-disc [&_ul]:pl-5 [&_ol]:list-decimal [&_ol]:pl-5\"\n          >\n            {message.content}\n          </MarkdownTextPrimitive>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AAOA,MAAM,gBAAgB;IACpB,MAAM;IACN,WAAW;AACb;AAEO,SAAS,cAAc,EAAE,OAAO,EAAsB;IAC3D,MAAM,SAAS,QAAQ,IAAI,KAAK;IAEhC,qBACE,+QAAC;QAAI,WAAW,CAAC,YAAY,EAAE,SAAS,gBAAgB,iBAAiB;kBACvE,cAAA,+QAAC;YACC,WAAU;YACV,OAAO;gBACL,iBAAiB,SAAS,cAAc,IAAI,GAAG,cAAc,SAAS;YACxE;;gBAEC,QAAQ,SAAS,IAAI,QAAQ,SAAS,CAAC,MAAM,GAAG,mBAC/C,+QAAC;oBAAI,WAAU;8BACZ,QAAQ,SAAS,CAAC,GAAG,CAAC,CAAC,qBACtB,+QAAC;4BAEC,WAAU;;8CAEV,+QAAC;oCAAI,WAAU;;sDACb,+QAAC,wOAAG;4CAAC,WAAU;;;;;;sDACf,+QAAC;sDAAM,KAAK,IAAI;;;;;;;;;;;;gCAEjB,KAAK,MAAM,kBACV,+QAAC;oCAAI,WAAU;8CAAsB,KAAK,MAAM;;;;;;;2BAR7C,KAAK,EAAE;;;;;;;;;;gBAcnB,uBACC,+QAAC;oBAAE,WAAU;8BACV,QAAQ,OAAO;;;;;yCAGlB,+QAAC;oBACC,WAAU;8BAET,QAAQ,OAAO;;;;;;;;;;;;;;;;;AAM5B"}},
    {"offset": {"line": 391, "column": 0}, "map": {"version":3,"sources":["file:///Users/haoqi/OnePersonCompany/friendsAI/packages/client/components/chat/ContactPreviewCard.tsx"],"sourcesContent":["import type { ContactCard } from '@/types';\nimport { Mail, Phone, Building2, Briefcase, Tag } from 'lucide-react';\n\ninterface ContactPreviewCardProps {\n  card: ContactCard;\n  pendingConfirmation?: boolean;\n  onConfirm?: () => void;\n  onDismiss?: () => void;\n}\n\nexport function ContactPreviewCard({\n  card,\n  pendingConfirmation = false,\n  onConfirm,\n  onDismiss,\n}: ContactPreviewCardProps) {\n  return (\n    <div className=\"mx-2 my-2 rounded-[16px] border border-gray-200 bg-white p-4\">\n      <div className=\"space-y-3\">\n        {/* Name */}\n        {card.name && (\n          <div>\n            <h4 className=\"text-base font-semibold text-gray-900\">\n              {card.name}\n            </h4>\n          </div>\n        )}\n\n        {/* Contact Info */}\n        <div className=\"space-y-2 text-sm text-gray-600\">\n          {card.email && (\n            <div className=\"flex items-center gap-2\">\n              <Mail className=\"h-4 w-4 flex-shrink-0\" />\n              <span>{card.email}</span>\n            </div>\n          )}\n          {card.phone && (\n            <div className=\"flex items-center gap-2\">\n              <Phone className=\"h-4 w-4 flex-shrink-0\" />\n              <span>{card.phone}</span>\n            </div>\n          )}\n          {card.company && (\n            <div className=\"flex items-center gap-2\">\n              <Building2 className=\"h-4 w-4 flex-shrink-0\" />\n              <span>{card.company}</span>\n            </div>\n          )}\n          {card.title && (\n            <div className=\"flex items-center gap-2\">\n              <Briefcase className=\"h-4 w-4 flex-shrink-0\" />\n              <span>{card.title}</span>\n            </div>\n          )}\n        </div>\n\n        {/* Tags */}\n        {card.tags && card.tags.length > 0 && (\n          <div className=\"flex flex-wrap gap-1.5\">\n            {card.tags.map((tag, index) => (\n              <span\n                key={index}\n                className=\"inline-flex items-center gap-1 rounded-full bg-blue-50 px-2 py-0.5 text-xs font-medium text-blue-600\"\n              >\n                <Tag className=\"h-3 w-3\" />\n                {tag}\n              </span>\n            ))}\n          </div>\n        )}\n\n        {/* Notes */}\n        {card.notes && (\n          <div className=\"rounded-lg bg-gray-50 p-2 text-sm text-gray-600\">\n            {card.notes}\n          </div>\n        )}\n\n        {pendingConfirmation && (\n          <div className=\"flex items-center gap-2 pt-1\">\n            <button\n              type=\"button\"\n              onClick={onConfirm}\n              className=\"rounded-full bg-[#007AFF] px-3 py-1.5 text-xs font-medium text-white transition-colors hover:bg-blue-600\"\n            >\n              确认添加联系人\n            </button>\n            <button\n              type=\"button\"\n              onClick={onDismiss}\n              className=\"rounded-full border border-gray-300 px-3 py-1.5 text-xs font-medium text-gray-700 transition-colors hover:bg-gray-100\"\n            >\n              暂不添加\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AAAA;AAAA;AAAA;AAAA;;;AASO,SAAS,mBAAmB,EACjC,IAAI,EACJ,sBAAsB,KAAK,EAC3B,SAAS,EACT,SAAS,EACe;IACxB,qBACE,+QAAC;QAAI,WAAU;kBACb,cAAA,+QAAC;YAAI,WAAU;;gBAEZ,KAAK,IAAI,kBACR,+QAAC;8BACC,cAAA,+QAAC;wBAAG,WAAU;kCACX,KAAK,IAAI;;;;;;;;;;;8BAMhB,+QAAC;oBAAI,WAAU;;wBACZ,KAAK,KAAK,kBACT,+QAAC;4BAAI,WAAU;;8CACb,+QAAC,2OAAI;oCAAC,WAAU;;;;;;8CAChB,+QAAC;8CAAM,KAAK,KAAK;;;;;;;;;;;;wBAGpB,KAAK,KAAK,kBACT,+QAAC;4BAAI,WAAU;;8CACb,+QAAC,8OAAK;oCAAC,WAAU;;;;;;8CACjB,+QAAC;8CAAM,KAAK,KAAK;;;;;;;;;;;;wBAGpB,KAAK,OAAO,kBACX,+QAAC;4BAAI,WAAU;;8CACb,+QAAC,8PAAS;oCAAC,WAAU;;;;;;8CACrB,+QAAC;8CAAM,KAAK,OAAO;;;;;;;;;;;;wBAGtB,KAAK,KAAK,kBACT,+QAAC;4BAAI,WAAU;;8CACb,+QAAC,0PAAS;oCAAC,WAAU;;;;;;8CACrB,+QAAC;8CAAM,KAAK,KAAK;;;;;;;;;;;;;;;;;;gBAMtB,KAAK,IAAI,IAAI,KAAK,IAAI,CAAC,MAAM,GAAG,mBAC/B,+QAAC;oBAAI,WAAU;8BACZ,KAAK,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,sBACnB,+QAAC;4BAEC,WAAU;;8CAEV,+QAAC,wOAAG;oCAAC,WAAU;;;;;;gCACd;;2BAJI;;;;;;;;;;gBAWZ,KAAK,KAAK,kBACT,+QAAC;oBAAI,WAAU;8BACZ,KAAK,KAAK;;;;;;gBAId,qCACC,+QAAC;oBAAI,WAAU;;sCACb,+QAAC;4BACC,MAAK;4BACL,SAAS;4BACT,WAAU;sCACX;;;;;;sCAGD,+QAAC;4BACC,MAAK;4BACL,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;;;;;;;;;;;;AAQb"}},
    {"offset": {"line": 601, "column": 0}, "map": {"version":3,"sources":["file:///Users/haoqi/OnePersonCompany/friendsAI/packages/client/components/chat/MessageList.tsx"],"sourcesContent":["import { MessageBubble } from './MessageBubble';\nimport { ContactPreviewCard } from './ContactPreviewCard';\nimport type { Message } from '@/types';\nimport { forwardRef } from 'react';\n\n\ninterface MessageListProps {\n  messages: Message[];\n  onConfirmContactCard: (messageId: string) => void;\n  onDismissContactCard: (messageId: string) => void;\n}\n\nexport const MessageList = forwardRef<HTMLDivElement, MessageListProps>(\n  ({ messages, onConfirmContactCard, onDismissContactCard }, ref) => {\n    return (\n      <div\n        ref={ref}\n        className=\"flex flex-1 flex-col gap-3 overflow-y-auto px-4 py-4\"\n      >\n        {messages.map((message) => (\n          <div key={message.id} className=\"flex flex-col\">\n            <MessageBubble message={message} />\n            {message.contactCard && (\n              <ContactPreviewCard\n                card={message.contactCard}\n                pendingConfirmation={Boolean(message.pendingContactCardConfirmation)}\n                onConfirm={() => onConfirmContactCard(message.id)}\n                onDismiss={() => onDismissContactCard(message.id)}\n              />\n            )}\n          </div>\n        ))}\n      </div>\n    );\n  }\n);\n\nMessageList.displayName = 'MessageList';\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAEA;;;;;AASO,MAAM,4BAAc,IAAA,oPAAU,EACnC,CAAC,EAAE,QAAQ,EAAE,oBAAoB,EAAE,oBAAoB,EAAE,EAAE;IACzD,qBACE,+QAAC;QACC,KAAK;QACL,WAAU;kBAET,SAAS,GAAG,CAAC,CAAC,wBACb,+QAAC;gBAAqB,WAAU;;kCAC9B,+QAAC,4MAAa;wBAAC,SAAS;;;;;;oBACvB,QAAQ,WAAW,kBAClB,+QAAC,sNAAkB;wBACjB,MAAM,QAAQ,WAAW;wBACzB,qBAAqB,QAAQ,QAAQ,8BAA8B;wBACnE,WAAW,IAAM,qBAAqB,QAAQ,EAAE;wBAChD,WAAW,IAAM,qBAAqB,QAAQ,EAAE;;;;;;;eAP5C,QAAQ,EAAE;;;;;;;;;;AAc5B;AAGF,YAAY,WAAW,GAAG"}},
    {"offset": {"line": 654, "column": 0}, "map": {"version":3,"sources":["file:///Users/haoqi/OnePersonCompany/friendsAI/packages/client/components/drawer/ContactsDrawer.tsx"],"sourcesContent":["import { X, Plus } from 'lucide-react';\nimport { useChatStore } from '@/stores/chat';\n\ninterface ContactsDrawerProps {\n  onAddContact: () => void;\n}\n\nexport function ContactsDrawer({ onAddContact }: ContactsDrawerProps) {\n  const { isDrawerOpen, setDrawerOpen, contacts, activeContactId, setActiveContact } =\n    useChatStore();\n\n  if (!isDrawerOpen) return null;\n\n  return (\n    <>\n      <div\n        className=\"fixed inset-0 z-40 bg-black/20\"\n        onClick={() => setDrawerOpen(false)}\n      />\n\n      <aside className=\"fixed left-0 top-0 z-50 flex h-full w-[280px] flex-col border-r border-gray-200 bg-white\">\n        <header className=\"flex h-16 items-center justify-between border-b border-gray-200 px-4\">\n          <h2 className=\"text-base font-semibold text-gray-900\">联系人</h2>\n\n          <div className=\"flex items-center gap-2\">\n            <button\n              type=\"button\"\n              className=\"flex h-6 w-6 items-center justify-center text-blue-500\"\n              aria-label=\"Add contact\"\n              onClick={onAddContact}\n            >\n              <Plus className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setDrawerOpen(false)}\n              className=\"flex h-6 w-6 items-center justify-center text-gray-400\"\n              aria-label=\"Close drawer\"\n            >\n              <X className=\"h-5 w-5\" />\n            </button>\n          </div>\n        </header>\n\n        <div className=\"flex-1 overflow-y-auto p-2\">\n          {contacts.map((contact) => {\n            const isActive = contact.id === activeContactId;\n\n            return (\n              <button\n                type=\"button\"\n                key={contact.id}\n                onClick={() => setActiveContact(contact.id)}\n                className={`flex w-full items-center gap-3 rounded-xl px-3 py-2 text-left transition-colors ${\n                  isActive ? 'bg-gray-100' : 'hover:bg-gray-50'\n                }`}\n              >\n                <div\n                  className=\"flex h-10 flex-shrink-0 items-center justify-center rounded-full text-sm font-medium text-white\"\n                  style={{ backgroundColor: contact.avatarColor }}\n                >\n                  {contact.name.charAt(0).toUpperCase()}\n                </div>\n\n                <span className=\"flex-1 truncate text-sm font-medium text-gray-900\">\n                  {contact.name}\n                </span>\n              </button>\n            );\n          })}\n\n          {contacts.length === 0 && (\n            <div className=\"py-8 text-center text-sm text-gray-400\">暂无联系人</div>\n          )}\n        </div>\n      </aside>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AACA;;;;AAMO,SAAS,eAAe,EAAE,YAAY,EAAuB;IAClE,MAAM,EAAE,YAAY,EAAE,aAAa,EAAE,QAAQ,EAAE,eAAe,EAAE,gBAAgB,EAAE,GAChF,IAAA,qLAAY;IAEd,IAAI,CAAC,cAAc,OAAO;IAE1B,qBACE;;0BACE,+QAAC;gBACC,WAAU;gBACV,SAAS,IAAM,cAAc;;;;;;0BAG/B,+QAAC;gBAAM,WAAU;;kCACf,+QAAC;wBAAO,WAAU;;0CAChB,+QAAC;gCAAG,WAAU;0CAAwC;;;;;;0CAEtD,+QAAC;gCAAI,WAAU;;kDACb,+QAAC;wCACC,MAAK;wCACL,WAAU;wCACV,cAAW;wCACX,SAAS;kDAET,cAAA,+QAAC,2OAAI;4CAAC,WAAU;;;;;;;;;;;kDAElB,+QAAC;wCACC,MAAK;wCACL,SAAS,IAAM,cAAc;wCAC7B,WAAU;wCACV,cAAW;kDAEX,cAAA,+QAAC,kOAAC;4CAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;kCAKnB,+QAAC;wBAAI,WAAU;;4BACZ,SAAS,GAAG,CAAC,CAAC;gCACb,MAAM,WAAW,QAAQ,EAAE,KAAK;gCAEhC,qBACE,+QAAC;oCACC,MAAK;oCAEL,SAAS,IAAM,iBAAiB,QAAQ,EAAE;oCAC1C,WAAW,CAAC,gFAAgF,EAC1F,WAAW,gBAAgB,oBAC3B;;sDAEF,+QAAC;4CACC,WAAU;4CACV,OAAO;gDAAE,iBAAiB,QAAQ,WAAW;4CAAC;sDAE7C,QAAQ,IAAI,CAAC,MAAM,CAAC,GAAG,WAAW;;;;;;sDAGrC,+QAAC;4CAAK,WAAU;sDACb,QAAQ,IAAI;;;;;;;mCAdV,QAAQ,EAAE;;;;;4BAkBrB;4BAEC,SAAS,MAAM,KAAK,mBACnB,+QAAC;gCAAI,WAAU;0CAAyC;;;;;;;;;;;;;;;;;;;;AAMpE"}},
    {"offset": {"line": 804, "column": 0}, "map": {"version":3,"sources":["file:///Users/haoqi/OnePersonCompany/friendsAI/packages/client/lib/db.ts"],"sourcesContent":["import Dexie, { Table } from 'dexie';\nimport type { Contact, Message, Conversation, ContactCard } from '@/types';\n\nexport class FriendsDatabase extends Dexie {\n  contacts!: Table<Contact>;\n  messages!: Table<Message>;\n  conversations!: Table<Conversation>;\n  contactCards!: Table<ContactCard>;\n\n  constructor() {\n    super('FriendsAI');\n    this.version(1).stores({\n      contacts: 'id, name, createdAt, updatedAt',\n      messages: 'id, contactId, role, createdAt',\n      conversations: 'id, contactId, lastMessageAt, messageCount',\n      contactCards: 'id, name, email, phone, company, createdAt, sourceMessageId',\n    });\n  }\n}\n\nexport const db = new FriendsDatabase();\n\nexport async function getAllContacts(): Promise<Contact[]> {\n  return db.contacts.orderBy('updatedAt').reverse().toArray();\n}\n\nexport async function saveContact(contact: Contact): Promise<void> {\n  await db.contacts.put(contact);\n}\n\nexport async function getMessagesByContact(contactId: string): Promise<Message[]> {\n  return db.messages.where('contactId').equals(contactId).sortBy('createdAt');\n}\n\nexport async function saveMessage(message: Message): Promise<void> {\n  await db.messages.put(message);\n}\n\nexport async function saveContactCard(card: ContactCard): Promise<void> {\n  await db.contactCards.put(card);\n}\n\nexport async function clearAllData(): Promise<void> {\n  await db.transaction('rw', db.contacts, db.messages, db.contactCards, async () => {\n    await db.contacts.clear();\n    await db.messages.clear();\n    await db.contactCards.clear();\n  });\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;AAGO,MAAM,wBAAwB,uLAAK;IACxC,SAA0B;IAC1B,SAA0B;IAC1B,cAAoC;IACpC,aAAkC;IAElC,aAAc;QACZ,KAAK,CAAC;QACN,IAAI,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC;YACrB,UAAU;YACV,UAAU;YACV,eAAe;YACf,cAAc;QAChB;IACF;AACF;AAEO,MAAM,KAAK,IAAI;AAEf,eAAe;IACpB,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,aAAa,OAAO,GAAG,OAAO;AAC3D;AAEO,eAAe,YAAY,OAAgB;IAChD,MAAM,GAAG,QAAQ,CAAC,GAAG,CAAC;AACxB;AAEO,eAAe,qBAAqB,SAAiB;IAC1D,OAAO,GAAG,QAAQ,CAAC,KAAK,CAAC,aAAa,MAAM,CAAC,WAAW,MAAM,CAAC;AACjE;AAEO,eAAe,YAAY,OAAgB;IAChD,MAAM,GAAG,QAAQ,CAAC,GAAG,CAAC;AACxB;AAEO,eAAe,gBAAgB,IAAiB;IACrD,MAAM,GAAG,YAAY,CAAC,GAAG,CAAC;AAC5B;AAEO,eAAe;IACpB,MAAM,GAAG,WAAW,CAAC,MAAM,GAAG,QAAQ,EAAE,GAAG,QAAQ,EAAE,GAAG,YAAY,EAAE;QACpE,MAAM,GAAG,QAAQ,CAAC,KAAK;QACvB,MAAM,GAAG,QAAQ,CAAC,KAAK;QACvB,MAAM,GAAG,YAAY,CAAC,KAAK;IAC7B;AACF"}},
    {"offset": {"line": 866, "column": 0}, "map": {"version":3,"sources":["file:///Users/haoqi/OnePersonCompany/friendsAI/packages/client/app/chat/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef, useState } from 'react';\nimport { ChatComposer } from '@/components/chat/ChatComposer';\nimport { ChatHeader } from '@/components/chat/ChatHeader';\nimport { MessageList } from '@/components/chat/MessageList';\nimport { ContactsDrawer } from '@/components/drawer/ContactsDrawer';\nimport {\n  getAllContacts,\n  getMessagesByContact,\n  saveContact,\n  saveContactCard,\n  saveMessage,\n} from '@/lib/db';\nimport { useChatStore } from '@/stores/chat';\nimport type { Contact, ContactCard, Message } from '@/types';\n\nconst AVATAR_COLORS = ['#007AFF', '#34C759', '#FF9500', '#AF52DE', '#FF3B30', '#5856D6', '#FFCC00'] as const;\n\nconst INITIAL_CONTACTS: Contact[] = [\n  {\n    id: 'contact-zhangsan',\n    name: '张三',\n    avatarColor: AVATAR_COLORS[0],\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  },\n  {\n    id: 'contact-lisi',\n    name: '李四',\n    avatarColor: AVATAR_COLORS[1],\n    createdAt: new Date(),\n    updatedAt: new Date(),\n  },\n];\n\ninterface ChatApiResponse {\n  reply: string;\n  toolResult?: string;\n  contactCard?: Omit<ContactCard, 'createdAt'> & { createdAt: string };\n  requestId?: string;\n}\n\ninterface ChatToolsPayload {\n  enabled: Array<'extract_contact_info' | 'feishu_template_message'>;\n  feishuTemplateMessage?: {\n    mode: 'sync' | 'preview';\n  };\n}\n\ntype ComposerTool = 'add' | 'image' | 'camera' | 'gif' | 'location';\n\nfunction createMessageId(prefix: string): string {\n  return `${prefix}-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n}\n\nfunction createContactName(contactCount: number): string {\n  return `新联系人${contactCount + 1}`;\n}\n\nfunction mapToolName(tool: ComposerTool): string {\n  if (tool === 'add') return '添加附件';\n  if (tool === 'image') return '图片';\n  if (tool === 'camera') return '拍照';\n  if (tool === 'gif') return 'GIF';\n  return '位置';\n}\n\nfunction buildChatToolsPayload(\n  isFeishuToolEnabled: boolean,\n  feishuMode: 'sync' | 'preview'\n): ChatToolsPayload {\n  if (!isFeishuToolEnabled) {\n    return {\n      enabled: ['extract_contact_info'],\n    };\n  }\n\n  return {\n    enabled: ['extract_contact_info', 'feishu_template_message'],\n    feishuTemplateMessage: {\n      mode: feishuMode,\n    },\n  };\n}\n\nexport default function ChatPage() {\n  const {\n    activeContactId,\n    contacts,\n    messages,\n    setContacts,\n    addContact,\n    setActiveContact,\n    setMessages,\n    addMessage,\n    updateMessage,\n  } = useChatStore();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isFeishuToolEnabled, setIsFeishuToolEnabled] = useState(false);\n  const [feishuMode, setFeishuMode] = useState<'sync' | 'preview'>('sync');\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const bootstrap = async () => {\n      try {\n        const storedContacts = await getAllContacts();\n        const initialContacts = storedContacts.length > 0 ? storedContacts : INITIAL_CONTACTS;\n\n        if (storedContacts.length === 0) {\n          await Promise.all(initialContacts.map((contact) => saveContact(contact)));\n        }\n\n        setContacts(initialContacts);\n\n        if (initialContacts.length > 0) {\n          setActiveContact(initialContacts[0].id);\n        }\n      } catch {\n        setContacts(INITIAL_CONTACTS);\n        setActiveContact(INITIAL_CONTACTS[0].id);\n      }\n    };\n\n    void bootstrap();\n  }, [setActiveContact, setContacts]);\n\n  useEffect(() => {\n    const loadActiveMessages = async () => {\n      if (!activeContactId) {\n        return;\n      }\n\n      try {\n        const storedMessages = await getMessagesByContact(activeContactId);\n        setMessages(activeContactId, storedMessages);\n      } catch {\n        setMessages(activeContactId, []);\n      }\n    };\n\n    void loadActiveMessages();\n  }, [activeContactId, setMessages]);\n\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [activeContactId, messages]);\n\n  const activeContact = contacts.find((contact) => contact.id === activeContactId) ?? null;\n  const currentMessages = activeContactId ? messages[activeContactId] ?? [] : [];\n\n  const updateMessageById = async (\n    contactId: string,\n    messageId: string,\n    updater: (message: Message) => Message\n  ) => {\n    const targetMessage = (messages[contactId] ?? []).find((message) => message.id === messageId);\n    if (!targetMessage) {\n      return;\n    }\n\n    const updatedMessage = updater(targetMessage);\n    updateMessage(contactId, messageId, updater);\n\n    try {\n      await saveMessage(updatedMessage);\n    } catch {\n      // Keep optimistic UI behavior for local-first flow.\n    }\n  };\n\n  const handleConfirmContactCard = async (messageId: string) => {\n    if (!activeContactId) {\n      return;\n    }\n\n    const message = (messages[activeContactId] ?? []).find((item) => item.id === messageId);\n\n    if (!message?.contactCard) {\n      return;\n    }\n\n    try {\n      await saveContactCard(message.contactCard);\n    } catch {\n      // Keep optimistic UI behavior for local-first flow.\n    }\n\n    await updateMessageById(activeContactId, messageId, (item) => ({\n      ...item,\n      pendingContactCardConfirmation: false,\n    }));\n  };\n\n  const handleDismissContactCard = async (messageId: string) => {\n    if (!activeContactId) {\n      return;\n    }\n\n    await updateMessageById(activeContactId, messageId, (item) => ({\n      ...item,\n      pendingContactCardConfirmation: false,\n    }));\n  };\n\n  const handleAddContact = async () => {\n    const newContact: Contact = {\n      id: createMessageId('contact'),\n      name: createContactName(contacts.length),\n      avatarColor: AVATAR_COLORS[contacts.length % AVATAR_COLORS.length],\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    addContact(newContact);\n    setActiveContact(newContact.id);\n\n    try {\n      await saveContact(newContact);\n    } catch {\n      // Keep optimistic UI behavior for local-first flow.\n    }\n  };\n\n  const handleToolAction = async (tool: ComposerTool) => {\n    if (!activeContactId) {\n      return;\n    }\n\n    const toolMessage: Message = {\n      id: createMessageId('tool-action'),\n      contactId: activeContactId,\n      role: 'assistant',\n      content: '',\n      toolCalls: [\n        {\n          id: createMessageId('tool-call'),\n          name: mapToolName(tool),\n          arguments: {},\n          result: `${mapToolName(tool)}功能将在后续版本开放`,\n        },\n      ],\n      createdAt: new Date(),\n    };\n\n    addMessage(activeContactId, toolMessage);\n\n    try {\n      await saveMessage(toolMessage);\n    } catch {\n      // Keep optimistic UI behavior for local-first flow.\n    }\n  };\n\n  const handleVoiceInput = async () => {\n    if (!activeContactId) {\n      return;\n    }\n\n    const voiceMessage: Message = {\n      id: createMessageId('voice-hint'),\n      contactId: activeContactId,\n      role: 'assistant',\n      content: '语音输入暂未接入，请先使用文本输入。',\n      createdAt: new Date(),\n    };\n\n    addMessage(activeContactId, voiceMessage);\n\n    try {\n      await saveMessage(voiceMessage);\n    } catch {\n      // Keep optimistic UI behavior for local-first flow.\n    }\n  };\n\n  const handleSendMessage = async (content: string) => {\n    if (!activeContactId || !activeContact) {\n      return;\n    }\n\n    const normalizedContent = content.trim();\n    if (!normalizedContent) {\n      return;\n    }\n\n    const userMessage: Message = {\n      id: createMessageId('user'),\n      contactId: activeContactId,\n      role: 'user',\n      content: normalizedContent,\n      createdAt: new Date(),\n    };\n\n    addMessage(activeContactId, userMessage);\n\n    try {\n      await saveMessage(userMessage);\n    } catch {\n      // Keep optimistic UI behavior for local-first flow.\n    }\n\n    setIsLoading(true);\n\n    let payload: ChatApiResponse | null = null;\n    const toolsPayload = buildChatToolsPayload(isFeishuToolEnabled, feishuMode);\n\n    try {\n      const requestPayload = {\n        contact: activeContact,\n        messages: [...currentMessages, userMessage]\n          .filter((message) => message.content.trim().length > 0)\n          .map((message) => ({\n            role: message.role,\n            content: message.content,\n          })),\n        tools: toolsPayload,\n      };\n\n      const response = await fetch('/api/chat', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(requestPayload),\n      });\n\n      if (!response.ok) {\n        const errorBody = (await response.json().catch(() => null)) as\n          | {\n              error?: string;\n              requestId?: string;\n            }\n          | null;\n\n        console.error('[chat-page] /api/chat request failed', {\n          status: response.status,\n          statusText: response.statusText,\n          requestId: errorBody?.requestId,\n          error: errorBody?.error,\n          contactId: activeContact.id,\n          messageCount: requestPayload.messages.length,\n          enabledTools: requestPayload.tools.enabled,\n          feishuMode: requestPayload.tools.feishuTemplateMessage?.mode,\n        });\n\n        throw new Error(errorBody?.error ?? '聊天服务请求失败');\n      }\n\n      payload = (await response.json()) as ChatApiResponse;\n\n      console.info('[chat-page] /api/chat request succeeded', {\n        requestId: payload.requestId,\n        contactId: activeContact.id,\n        messageCount: requestPayload.messages.length,\n        hasToolResult: Boolean(payload.toolResult),\n      });\n    } catch (error) {\n      console.error('[chat-page] failed to send message', {\n        contactId: activeContact.id,\n        error: error instanceof Error ? error.message : String(error),\n      });\n\n      const fallbackMessage: Message = {\n        id: createMessageId('assistant-error'),\n        contactId: activeContactId,\n        role: 'assistant',\n        content: '当前 AI 服务不可用，请检查本地代理配置后重试。',\n        createdAt: new Date(),\n      };\n\n      addMessage(activeContactId, fallbackMessage);\n\n      try {\n        await saveMessage(fallbackMessage);\n      } catch {\n        // Keep optimistic UI behavior for local-first flow.\n      }\n\n      setIsLoading(false);\n      return;\n    }\n\n    if (payload.toolResult) {\n      const normalizedCard = payload.contactCard\n        ? {\n            ...payload.contactCard,\n            createdAt: new Date(payload.contactCard.createdAt),\n          }\n        : undefined;\n\n      const toolMessage: Message = {\n        id: createMessageId('assistant-tool'),\n        contactId: activeContactId,\n        role: 'assistant',\n        content: '',\n        toolCalls: [\n          {\n            id: createMessageId('extract-contact'),\n            name: 'extract_contact_info',\n            arguments: {},\n            result: payload.toolResult,\n          },\n        ],\n        contactCard: normalizedCard,\n        pendingContactCardConfirmation: Boolean(normalizedCard),\n        createdAt: new Date(),\n      };\n\n      addMessage(activeContactId, toolMessage);\n\n      try {\n        await saveMessage(toolMessage);\n      } catch {\n        // Keep optimistic UI behavior for local-first flow.\n      }\n    }\n\n    const assistantMessage: Message = {\n      id: createMessageId('assistant'),\n      contactId: activeContactId,\n      role: 'assistant',\n      content: payload.reply || '我已经记下来了。',\n      createdAt: new Date(),\n    };\n\n    addMessage(activeContactId, assistantMessage);\n\n    try {\n      await saveMessage(assistantMessage);\n    } catch {\n      // Keep optimistic UI behavior for local-first flow.\n    }\n\n    setIsLoading(false);\n  };\n\n  return (\n    <div className=\"flex h-screen w-full flex-col bg-[#F5F5F7]\">\n      <ContactsDrawer onAddContact={handleAddContact} />\n\n      <main className=\"flex flex-1 flex-col\">\n        <ChatHeader contact={activeContact} />\n\n        <MessageList\n          messages={currentMessages}\n          onConfirmContactCard={handleConfirmContactCard}\n          onDismissContactCard={handleDismissContactCard}\n        />\n        <div ref={messagesEndRef} />\n\n        <div className=\"flex items-center justify-between border-t border-gray-200 bg-white px-4 py-2 text-xs text-gray-600\">\n          <label className=\"flex items-center gap-2\">\n            <input\n              type=\"checkbox\"\n              checked={isFeishuToolEnabled}\n              onChange={(event) => setIsFeishuToolEnabled(event.target.checked)}\n              disabled={isLoading}\n            />\n            <span>开启飞书多维表工具</span>\n          </label>\n          <label className=\"flex items-center gap-2\">\n            <span>模式</span>\n            <select\n              value={feishuMode}\n              onChange={(event) => setFeishuMode(event.target.value as 'sync' | 'preview')}\n              disabled={!isFeishuToolEnabled || isLoading}\n              className=\"rounded border border-gray-300 bg-white px-2 py-1 text-xs\"\n            >\n              <option value=\"sync\">sync</option>\n              <option value=\"preview\">preview</option>\n            </select>\n          </label>\n        </div>\n\n        <ChatComposer\n          onSendMessage={handleSendMessage}\n          onToolAction={handleToolAction}\n          onVoiceInput={handleVoiceInput}\n          disabled={isLoading}\n        />\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}