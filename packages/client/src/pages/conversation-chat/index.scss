.chat-page {
  min-height: 100vh;
  background: #F7F6F3;
  display: flex;
  flex-direction: column;

  .loading-state {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #8E8E93;
  }

  .message-list {
    flex: 1;
    padding: 32rpx 32rpx 220rpx;
    box-sizing: border-box;
  }

  .message-row {
    display: flex;
    flex-direction: column;
    margin-bottom: 24rpx;
    align-items: flex-start;

    &.user {
      align-items: flex-end;
    }
  }

  .assistant-label {
    display: flex;
    align-items: center;
    gap: 12rpx;
    margin-bottom: 12rpx;

    .icon-ai {
      width: 32rpx;
      height: 32rpx;
      background: rgba(124, 144, 112, 0.2);
      border-radius: 8rpx;
      position: relative;

      &:after {
        content: '';
        position: absolute;
        top: 6rpx;
        left: 6rpx;
        width: 20rpx;
        height: 20rpx;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%237C9070' stroke-width='2'%3E%3Cpath d='m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z'/%3E%3C/svg%3E");
        background-size: contain;
        background-repeat: no-repeat;
      }
    }

    .assistant-text {
      font-size: 24rpx;
      color: #8E8E93;
      font-weight: 500;
    }
  }

  .bubble {
    max-width: 78%;
    padding: 20rpx 28rpx;
    border-radius: 24rpx;
    font-size: 28rpx;
    line-height: 1.6;

    &.user {
      background: #7C9070;
      color: #FFFFFF;
      border-bottom-right-radius: 8rpx;
    }

    &.assistant {
      background: #FFFFFF;
      color: #2D2D2D;
      border: 1rpx solid #F0EFEC;
      border-bottom-left-radius: 8rpx;
    }

    .bubble-text {
      color: inherit;
      font-size: 28rpx;
      line-height: 1.6;
    }
  }

  .tool-card {
    width: 100%;
    background: #FFFFFF;
    border-radius: 24rpx;
    padding: 24rpx 28rpx;
    border: 1rpx solid #F0EFEC;
    box-sizing: border-box;

    .tool-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16rpx;

      .tool-title {
        font-size: 28rpx;
        font-weight: 600;
        color: #2D2D2D;
      }

      .tool-status {
        padding: 4rpx 16rpx;
        border-radius: 12rpx;

        &.running {
          background: rgba(91, 155, 213, 0.12);
        }

        &.success {
          background: rgba(124, 144, 112, 0.12);
        }

        &.failed {
          background: rgba(212, 132, 94, 0.12);
        }

        .tool-status-text {
          font-size: 22rpx;
          font-weight: 500;
          color: #6B6B6B;
        }
      }
    }

    .tool-body {
      display: flex;
      flex-direction: column;
      gap: 6rpx;

      .tool-line {
        font-size: 24rpx;
        color: #6B6B6B;
      }

      .tool-error {
        font-size: 24rpx;
        color: #D4845E;
      }
    }

    .tool-loading {
      margin-top: 16rpx;
      display: flex;
      align-items: center;
      gap: 12rpx;

      .loading-dot {
        width: 12rpx;
        height: 12rpx;
        border-radius: 6rpx;
        background: #5B9BD5;
        animation: pulse 1s infinite ease-in-out;
      }

      .loading-text {
        font-size: 22rpx;
        color: #5B9BD5;
      }
    }
  }

  .composer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: #FFFFFF;
    border-top: 1rpx solid #F0EFEC;
    padding: 20rpx 24rpx 40rpx;
    box-sizing: border-box;

    .composer-box {
      position: relative;
      background: #F7F6F3;
      border-radius: 24rpx;
      padding: 24rpx 88rpx 24rpx 24rpx;
    }

    .composer-input {
      width: 100%;
      min-height: 80rpx;
      font-size: 28rpx;
      color: #2D2D2D;
      line-height: 1.5;
    }

    .ai-entry {
      position: absolute;
      top: 16rpx;
      right: 16rpx;
      width: 64rpx;
      height: 64rpx;
      border-radius: 32rpx;
      background: rgba(124, 144, 112, 0.16);
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1rpx solid rgba(124, 144, 112, 0.4);

      .ai-entry-text {
        font-size: 24rpx;
        font-weight: 600;
        color: #7C9070;
      }
    }

    .composer-actions {
      display: flex;
      justify-content: flex-end;
      margin-top: 16rpx;
    }

    .send-btn {
      height: 72rpx;
      padding: 0 32rpx;
      background: #7C9070;
      border-radius: 20rpx;
      display: flex;
      align-items: center;
      gap: 12rpx;

      .icon-send {
        width: 32rpx;
        height: 32rpx;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23FFFFFF' stroke-width='2'%3E%3Cline x1='22' y1='2' x2='11' y2='13'/%3E%3Cpolygon points='22 2 15 22 11 13 2 9 22 2'/%3E%3C/svg%3E");
        background-size: contain;
        background-repeat: no-repeat;
      }

      .send-text {
        font-size: 28rpx;
        font-weight: 600;
        color: #FFFFFF;
      }
    }
  }
}

@keyframes pulse {
  0% { opacity: 0.3; }
  50% { opacity: 1; }
  100% { opacity: 0.3; }
}
